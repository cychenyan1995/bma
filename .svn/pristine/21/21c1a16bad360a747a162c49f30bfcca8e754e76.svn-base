{"version":3,"sources":["src/pages/sendMessage/index.js"],"names":["_react","_interopRequireWildcard","__webpack_require__","_Detail","_interopRequireDefault","_dva","SendMessage","connect","_ref","sendMessage","Component","constructor","props","super","this","setTitle","time","match","params","toDetail","record","text","setState","showDetail","monthSalesTaskDetailList","title","goBack","state","addColumns","width","dataIndex","key","_this$props$match$par","type","name","console","log","dispatch","payload","month","render","dataSource","data","length","columns","default","createElement","href","onClick","taskType","concat","view","_table","style","textAlign","bordered","pagination","_card"],"mappings":"8PAAAA,EAAAC,EAAAC,EAAA,SAEAC,EAAAC,EAAAF,EAAA,SACAG,EAAAH,EAAA,QAKMI,MAHL,EAAAD,EAAAE,SAAQC,IAAA,IAAGC,EAAHD,EAAGC,YAAH,OACPA,mCAEwBC,YAExBC,YAAYC,GACVC,MAAMD,GADWE,KAkCnBC,SAAW,MAGT,IAAMC,EAAOF,KAAKF,MAAMK,MAAMC,OAAOF,KACrC,MAAO,eAAOA,EAAO,yCAtCJF,KAyCnBK,SAAW,EAACC,EAAQC,KAClB,IAAML,EAAOF,KAAKF,MAAMK,MAAMC,OAAOF,KAErCF,KAAKQ,UAAWC,YAAY,EAAMC,yBAA0BJ,EAAOI,yBAA0BC,MAAOJ,EAAO,SAAML,MA5ChGF,KAiDnBY,OAAS,MACPZ,KAAKQ,UAAWC,YAAY,MAhD5BT,KAAKa,OACHJ,YAAY,EACZC,4BACAC,MAAO,GACPG,aACIH,MAAO,2BAAQI,MAAO,GAAIC,UAAW,eAAgBC,IAAK,iBAC1DN,MAAO,iCAASI,MAAO,IAAKC,UAAW,aAAcC,IAAK,gBAR/C,IAAAC,EAmBYlB,KAAKF,MAAMK,MAAMC,OAAtCe,EAnBSD,EAmBTC,KAAMC,EAnBGF,EAmBHE,KAAMlB,EAnBHgB,EAmBGhB,KAEpBmB,QAAQC,IAAIH,EAAMC,GArBD,IAuBTG,EAAavB,KAAKF,MAAlByB,SACRA,GACEJ,KAAM,iCACNK,SACEL,KAAMA,EACNC,KAAMA,EACNK,MAAOvB,KAwBbwB,SAAS,IAIC/B,EAAgBK,KAAKF,MAArBH,YACFgC,EAAahC,EAAYiC,KAC3BlB,KACqB,IAAtBiB,EAAWE,SACZnB,EAA2BiB,EAAW,GAAGjB,0BARpC,IAYCS,EAASnB,KAAKF,MAAMK,MAAMC,OAA1Be,KAEJW,IACAnB,MAAO,iCACPI,MAAO,IACPC,UAAW,UACXC,IAAK,UACLS,OAAQ,CAACnB,EAAMD,KACb,OACEpB,EAAA6C,QAAAC,cAAA,YAAM9C,EAAA6C,QAAAC,cAAA,KAAGC,KAAK,eAAeC,QAAS,IAAMlC,KAAKK,SAASC,EAAOC,IAAQA,OAI7EI,MAAO,2BAAQI,MAAO,GAAIC,UAAW,eAAgBC,IAAK,iBAGxDkB,EAAWnC,KAAKF,MAAMK,MAAMC,OAAO+B,SAGxB,MAAbA,IACFL,EAAUA,EAAQM,OAAOpC,KAAKa,MAAMC,aAGtC,IAAIuB,EAAO,GAEX,GAAa,OAATlB,EAAe,CACAnB,KAAKF,MAAMK,MAAMC,OAA1BgB,KACRiB,EACEnD,EAAA6C,QAAAC,cAAC3C,EAAA0C,SAAOZ,KAAMA,EAAMQ,WAAYjB,EAA0BC,MAAOX,KAAKa,MAAMF,MAAOwB,SAAUA,SAe7FE,EAXGrC,KAAKa,MAAMJ,WAYZvB,EAAA6C,QAAAC,cAAC3C,EAAA0C,SAAOZ,KAAMA,EAAMP,OAAQZ,KAAKY,OAAQe,WAAY3B,KAAKa,MAAMH,yBAA0BC,MAAOX,KAAKa,MAAMF,MAAOwB,SAAUA,IAV7HjD,EAAA6C,QAAAC,cAAAM,EAAAP,SAAOQ,OAAQC,UAAW,UAC5BV,QAASA,EACTH,WAAYA,EACZc,UAAQ,EACR9B,MAAOX,KAAKC,SACZyC,YAAY,IAYhB,OACExD,EAAA6C,QAAAC,cAAAW,EAAAZ,QAAA,KACGM,YAMM7C","file":"14.async.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { Card, Table } from 'antd';\r\nimport Detail from './components/Detail';\r\nimport { connect } from 'dva';\r\n\r\n@connect(({ sendMessage }) => ({\r\n  sendMessage\r\n}))\r\nclass SendMessage extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      showDetail: false,\r\n      monthSalesTaskDetailList: [],\r\n      title: '',\r\n      addColumns: [\r\n        { title: '总销售数', width: 80, dataIndex: 'totalSaleNum', key: 'totalSaleNum' },\r\n        { title: '任务完成率', width: 100, dataIndex: 'totalRatio', key: 'totalRatio' },\r\n      ]\r\n    }\r\n\r\n    /*    //得到传参，根据传参取后台数据，到页面展示\r\n        //type 类型标识\r\n        const type = this.props.match.params.type;\r\n        //对应的名称\r\n        const name = this.props.match.params.name;\r\n        //是不是只含有task任务数\r\n        const time = this.props.match.params.time;*/\r\n    const { type, name, time } = this.props.match.params;\r\n\r\n    console.log(type, name);\r\n\r\n    const { dispatch } = this.props;\r\n    dispatch({\r\n      type: 'sendMessage/fetchQuerySendInfo',\r\n      payload: {\r\n        type: type,\r\n        name: name,\r\n        month: time\r\n      }\r\n    })\r\n  }\r\n\r\n  setTitle = () => {\r\n    /*    let myDate = new Date();\r\n        let time = myDate.getFullYear() + '年' + myDate.getMonth();*/\r\n    const time = this.props.match.params.time;\r\n    return \"我的\" + time + \"销售任务报表\";\r\n  }\r\n\r\n  toDetail = (record, text) => {\r\n    const time = this.props.match.params.time;\r\n    //if(id){\r\n    this.setState({ showDetail: true, monthSalesTaskDetailList: record.monthSalesTaskDetailList, title: text + \"的\" + time });\r\n\r\n    //}\r\n  }\r\n\r\n  goBack = () => {\r\n    this.setState({ showDetail: false });\r\n  }\r\n\r\n  render() {\r\n    /*const dataSource = [\r\n      { manager: '华南', totalTaskNum: 100, totalSaleNum: 80, totalRatio: '80%' }\r\n    ]*/\r\n    const { sendMessage } = this.props;\r\n    const dataSource = sendMessage.data;\r\n    let monthSalesTaskDetailList = [];\r\n    if(dataSource.length !== 0){\r\n      monthSalesTaskDetailList = dataSource[0].monthSalesTaskDetailList;\r\n    }\r\n\r\n    // 得到类型 sp\r\n    const { type } = this.props.match.params;\r\n\r\n    let columns = [{\r\n        title: '任务责任人',\r\n        width: 100,\r\n        dataIndex: 'manager',\r\n        key: 'manager',\r\n        render: (text, record) => {\r\n          return (\r\n            <span><a href=\"javascript:;\" onClick={() => this.toDetail(record,text)}>{text}</a></span>\r\n          )\r\n        }\r\n      },\r\n      { title: '总任务数', width: 80, dataIndex: 'totalTaskNum', key: 'totalTaskNum' },\r\n    ];\r\n\r\n    const taskType = this.props.match.params.taskType;\r\n\r\n    /* taskType === 1  显示完成度   taskType === 0  不显示完成度*/\r\n    if (taskType === '1') {\r\n      columns = columns.concat(this.state.addColumns);\r\n    }\r\n\r\n    let view = '';\r\n    //如果是服务商直接显示详情页面\r\n    if (type === 'sp') {\r\n      const { name } = this.props.match.params;\r\n      view = (\r\n        <Detail type={type} dataSource={monthSalesTaskDetailList} title={this.state.title} taskType={taskType}\r\n       />\r\n      )\r\n    } else {\r\n      if (!this.state.showDetail) {\r\n        view = (\r\n          <Table style={{textAlign: 'center'}}\r\n        columns={columns}\r\n        dataSource={dataSource}\r\n        bordered\r\n        title={this.setTitle}\r\n        pagination={false}\r\n       />\r\n        )\r\n      } else {\r\n        view = (\r\n          <Detail type={type} goBack={this.goBack} dataSource={this.state.monthSalesTaskDetailList} title={this.state.title} taskType={taskType}\r\n       />\r\n        )\r\n      }\r\n    }\r\n\r\n\r\n    return (\r\n      <Card >\r\n        {view}\r\n      </Card>\r\n    )\r\n  }\r\n}\r\n\r\nexport default SendMessage\r\n"],"sourceRoot":""}